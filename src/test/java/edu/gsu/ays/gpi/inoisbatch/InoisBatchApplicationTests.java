package edu.gsu.ays.gpi.inoisbatch;

import edu.gsu.ays.gpi.inoisbatch.services.DecryptionService;
import edu.gsu.ays.gpi.inoisbatch.services.HashService;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class InoisBatchApplicationTests {

    @Test
    void contextLoads() {
    }

    @Test
    void testHashValue(){
        String mockSocialSecurityNumber = "123456789";
        String mockSaltKey = "a1s2d3f4g5h78";
        String hashedMockSocial = HashService.hashValue(mockSocialSecurityNumber, mockSaltKey);
        assert (!mockSocialSecurityNumber.equals(hashedMockSocial));
    }

    @Test
    void testEncryptionService(){
        //The contents below were encrypted with the 1st generation encryption key
        //rotating this key in Azure will require updating this test case
        String decryptedFileContents = ",Unnamed: 0,Name,SSN,School,Gov_Id,SSN_hash,Gov_Id_hash,SSN_previous_hashes,Gov_Id_previous_hashes\n" +
                "0,0,John J.,123456789,Lassiter,a1s2d3f4g,e1e1b86ef97273de348630967cab90c55c1e89fa749d71595891d4b8ff369e594e184220077e1c2bd2b21cc94ec04b9b985f89ce1df5fa91a1094009c3e061e3,a0abc8bb988b66e80d6713a32588a4ea2577b863c9bed279c82e3939a4c6470806953712b89c89bc6c88b7ed4125213faa8709452f0c8ca0928cefce53248411,d15e422e3bbb07f98a7380b89b0f17d2d969959c9d225ff7edd2d63919738a3e0006762ed748e4b2d541f6aa197a609bad28fcb4fbec37d8a9983bc8c3b7912d 36bc230a264ff381cbffde5dda9f0ba9349562703f8e6ce9686f02fb8d548f1b1a80d12374298e011037c3173fa810b8cccd00a7538040d2b13c1d94cb3497aa ,2dae0340019462c0cd8915d35e2306a03f5078687068e4f6829523d3a281be3098544cdf09190905b84e222942c847a9665450a06419d2f72ca164bfce5e0fe3 63d8441fef5294a04f4431d8eb83a0840befeb68aff4f78aa40af5a99a70e5ad4b743d08607d8fb53bc3352c5c1ea790f52c416ded9ab2ed9b5fa494d65e3b03 \n" +
                "1,1,Amy T.,234567891,North Cobb,k9kj7hg65,8112b9e48bea10d43969386c5282f06e64001dc623914325038c44647b74b57adca987009aef561285705a2ea3cb3b8ad39bbf8b4f89d27f2c1eb4a1b6fd432d,1eb35fc1f8e5d6939b3d23af528352d2ef588fc624e04ecd3c7ab7782cfd3ece8bd58439fcb539f0a11103416bca9863157038ae21aa2703e14cfc47b9387ac8,539ebf82b53a4b3d3cec7cba57caabcfb488075856628f6b2dc828bdb40d13469a6349e999cddd936f144009a023c962e6a50aa5c660071a59084497f1e123f8 f1a463801945f1ec91f9f933fedb225aaeff8872b6829d9ea6f89cbc46bb8f0eb1d5e6b79fa263462645674d184b393aeb53b676db8901eb05f867a277afc85d ,1a1bc214e606f1e89b2f6e17718992633fddecc28761103b9a9ab37e2d97116eccb6648fbe058b135873d508bcf1d1a44cee7f5c51b616509aae10071c0cca2c a4c868a85aa264127709e6290a41e079db9d4c714784e46f706f654791226f2d58d95a32e94397e26afd2a778c4f896aa6476c90e08174e716039bbccb6d9729 \n" +
                "2,2,Andrea A.,345678912,Kell,0o8un67c3,3a1d3f409fbbe76ab09708fc09fdb8c57f11b86e4ecc44d20921b062869bc15a41d23b030aa726b0d1a6c5b7241d03d18927b8c8d8e08ebfa055ec50eb35de99,07c5ef15a4784b0e46476c4a9e93aa4a57924574db3d0f927600295808f3ba14686aa4c29ebfb4c0c7bf9fe0aaf01dae5295aa0cf5908c1be7c52a0bc9f1b915,c79c8d33fb67489f5955a48b75aa30c39602727fe54e60befdc433d4d35348d4cfdb39c3a9aeb769e27c194cc878a59153fb03d08748235caec984674b16b220 28c7b41c34a1be01f683da4715aa4e760523814900830ba9b30a54f8b85ac34065b5d8b05acaafe99cf43d396e4dd3f70418754fd735c791981f077b433da326 ,46c091b58c6050aff478a6e064ef586b65df8158fa7b7eb60c52e8a41203f22da5f6202e52d4fadc9fa14d8a3f0ab5364494904a339f294eea160f502b889600 39ae95de91c22b36704304568a34c7928e6b11f32d51fb57c6f77ad653bd9a43eb7eada29b707e8eddd5218a8a05ad8369f471fa1dae80ece76a00c9c268f184 \n" +
                "3,3,Yanna Y.,456789123,Hopkins,22s111ju7,0459f718e917ea95ca09239bff4919d700c04fb0056342e4ee498b92e912c37f089bf95a08b0bd61f11e8d7aacdead2c636ec244d0fd461d08831925aadbf378,03dccfaba2cb82c4992847b59dfb156a4ea8989f912547e72bf2236abc028c5f78342da70e431b71f77877a008beba2eb2af98a87c24c786328349c6d5822f15,d731edc59eadce400475f6d10756f5da6c6a6b0c61aa73a947d4e74c3a38cbada56c58c5379bd1ba1155eb1c5f4f39f11a8424145a9060fb5f4a6bf847f7867d 63740d71c02271d6fa9ac5344bf886905608ef42bb5d6d868d2b483889d89c71c6e4170e8eccccf12419a3ea5d297694d15ba60124f26c351ebe442a7dd1dff6 ,02b63b01695ea3055cb357f9ecee25c9c04eee44b43269257e07e18aff09bb64ef6ba70888e0195a193a8fb5119189dbbda771cc90c06fa93c8fa06b63d42292 38836f61cdd7faa4beb6bc2051d6fd31aabe6519f609603eaeeec2a7a9dae3f683ce8bebb706e220ad12a9a096c1a11e9537fc7882bc27d1a1b7abf7d87d2a4c \n" +
                "4,4,David G.,567891234,Harvard,1j38dkm32,d221777a7cd148c567def9bb4be5c8de813dc5f3552a2bc06a349bf066dfff4a48e5d7f9feb17f9882e3b7c3295e22000d661f5bddce15734192eb60b938bb55,9719a21f13ecdfabc315f95fc583fb31902dae0e10d97269a827d334a00cc195df5f0eb013307affc95e19a9812d64ca888bf699408f060d367b6300155cff8e,26fab98b4762402978f60ecdb2149f97423b5797543ecbd7284170d0269ef298bb266c33ade9be893d1fe3604620e628cb7cd9d3245221855e7a797d7ac09bb4 8e17c37701175a0bfbbad9e2f04fd52f43caa2e46e572772b66cdb07ae91fc05765eb7868714b6ff0b46657dfebdbb3adb4cc00905e0a20e7a22fb123097e2d9 ,6ae4f2b48bdc8bb05d439e445468c19904da51c1e96c35bb0f83daf60ece536f88fd2a29e3ed0316bf8b6093163d2bc2377a2e2b61d3d7e18ddf6ab918209442 e819ba779dab26c4542d398eba7f2478fcd1292921692576489b27b8913bef9b43d61f21178eeaa9d19b103d1b24be642b70edbaf59d0efc959ade8fc7431bab \n" +
                "5,5,Timmy F.,678912345,UGA,hhhh77f4209,febc00f0ec25527133478a181010cd76261eff9127ffb61554ee864f9e871a8fdc0d7214455fa05f64826f6a6307ba252a99681d3de6c58cc8ee56bf05f7cd63,ca30ea9f9f34f61981594f768191f1d71b38c9a7ebb7edd9f348fb0699ec4a73e0a4c2db89b3f4ec7299e1731c3715ffd5144ee99c441a341583c708f7c9cebf,c79c512d8c480bd4ea051e2018b08d7eb22706fd89da5db13acd7e2a933696008252c3b821f25f27d31ddf23e08442202cbc5fa5465c62c1d6822e0ff0cdcf3a 77f8dad59dd1364b8ddc040dc13f02d0922f0580f96270e711edf7bd719c96ec4960e0e987bd3eda88f1438f9124bb70b17fa6a0b1f511a02d67cfd59f8ff388 ,d09683dd31e94857d7c10e12abe8ba8e5941ae3d5b28fccb12fb2214be4fc8e7f409880e90f6d4f5908530847600fcf4a6fb6238a2b5da89c1cdeb434cc3e23b da8709994385d82a302f7013a47ec51a62c7414cf2e6e81eb6debde2ff7f02133bcfa5c28fee5bd36db8b602ba536cb52e63a635cd8a29896619c9c8deaa6c70 \n";

        String encryptedFileContents = "gAAAAABevp3TDJHva_5rmZL3M0slUn1q2uiqfUlOH_qngYDQD--WD43PslV3iyx5ja8VDkYplTrqROo3ksJGw0XKSj33sWWDl__lXDOxxZJ4BlGWPTHl9yw_1BxxO4hrBk4PODG3TmA-qK8pwHV1LkBGkBpdNqG8f2GmUHqdBxiWom0Y_XNpQJiZUQ6xKMFSXuqvI1sF67v5dTp7z-H6aerNyRIm946d8nDoev4W6a12g8t4sxD-x4dwpvUNUcQcM3_hKDxNM5_sxAf7XjUCGmOxk_xDsjDBDgFFfQpEd2HZUX09zHyDKC8WfWNGIYrpxeoKAOPve4qiAxo4-Fz4O6rnt1FLTH9NUviIRO9kq9EpkHDvxjRiE4FOFn4pt6Z6AB9eTDgpx5Lu4BIL-dsGP0tVdBc-lJSi2-CemWxFAivP7Wu0fQUEsfwe7krZKU2PTB4Mnbuk8hBbaQb0CTiMH0XrulE_2BuyRvdI-ke6erZHJrPWG367hhRh8tdVVOUZDgARTa-K3YZXNMb8zyrH9CJVTz4_3R04ADtKlqJWfnqwdeko1Dm_0vBMZE0GZE1QNWzoV6r-xZgG3viWnNXlnWYrcUkGx3eJvq_7JDmR9hPoDKnQaARvh1LBtEheyVpDAK7iibA_aHCSu1L15o-7HRR_qG1hSbvx0eRP8GEQr1pMbb-IW6gwOEqPAvx0hGvThShlJd_PPW9xW1Zi7pVUAQf_czjdQZusMAEqPfrx-t6PrmKrfyaJRcSqxRAcPJzSliMCgUB60wOpb8tLelKd6NBKwDS7ySu11ee75OPigoJG_bModRJ-5JJl8Q5zRO-gFppoEWmSgp18x50yp4CrqnQWVsDN0ZJn43Ri_u1yYJ6hOIqZqOEPIuPOzS7WxccTICGqNxxTWdVprjYo6k7JGbI3T64QXR-lQpMBWajXqHxuJppZiKj-8L24tesWMEM13XTF8DBvxy_2nuIsBX8RxHuKP3405-JPuupmlFUw2tiYfVBdEfGY1pHXEGaPCxxNEfHkFKcTYKQNQPpKf8FblWjROqr268oMAC4tnWyMhnokcWZ8IV0lo2I4mK518t3JF8PVpNnJhH5tAOlcH9WQMZ2AcPns3o7QU_K0xZfCNwtSZ7THCza0s4EWLxVDWg-boCDPCLooesKTYjvIkVInJHFdgSfWXC7YnYGxGT3WuTXl9zLeLmFzeLq1r72paBAdx-E3aJGMYvLzPaHdol_ff_uHkHIpJ5_h6QGX1AFXVGAhUEGZfI5zs_RGxHL5E7GTAHSHpYQHYbC-fjtBiEcoZ-620NVaYWYNidiCpHPXCOQlThffYpCmha2m0Ty-KE34E5BWFQkMql7ljTtm9PPGdXFG5hzsy5VZAw1SAmk3wdVcXECab3zDcsuLMerRK7t_rO5odg52aISIr9JcoqgO7Bu_JCN1ir7V4ecx_abZHkhro1fCCm9uX8D4cbsMpuQtBlc7r4FHc-16ounIGW3eN1awhp5c7jNsnS8c4k7k5sR2R0bvOCCb8FB99E0A5q_L1mweUQHIyT-bN3Me9NVL4vcKgOZAPOIMDPSG8IzuEIxQ9xrYG1fCbY2Yoahd4RoAeGa15tynPvnYnBp5bVoMeyXlplsKblZYg9JnHKQxjvsWunodOzVWtgC784jD2fxK5ckBSj94rrDOJYUD2UEaL5basdjSSSH_JoxCj1LxikCSdr_XsH2lRPb2O25QjVGodqjHdqvTqcyrnr_cOLooLWPvb8jR6fckBS7fZhx4aVtHbBm7urnnXP6KTi_rd2XDMX8h2gxeELt5-8NBUQy1dNPB1qkGWaCsON9Lx0MEb18jKjgwgMcCi-9rpycDCrCI85zj2WRwrHCxx3Ly5XY1n-GEwaJyoBzDxvR-SP7dKBKdgH9jv8ktSHvKTXdG-EmebJmpzsObQZSpEyKLwFVNG948in0mCR1BQ4XQMRyH5Uo4xzrqzps74PaTjXmQcBu4BoRwtsGOLtjmaQzKVhHWiPy1h7QJzLAtcM2gxhf7VYdHKih06oXT04ohhnZIGsgdBcoEs6z44VL_sbqfmzUwAhx1dxfHLnPcTSzQezl9ayl37jIbU2tUhEpPBKFVyBAEQOqIUoZ8a827fF_FO2pBCiEMvC5KgfiVQ1PckpRu4edH77sbRKDr6fFLiT5v0OwekC7-NfW1RE4nrxyPfLh45LuJHhXzl2SaC1IyIL1zWDav1_RIZOQIB8MfgYRezcw4MWvoh4Bo4T9CXgW3wuvgnYIh0nzFJ7yNag2wob316cksmPJkhHBTeWfEVKB2riAgs9XmxC6GXYoOcQbfieaRBjilxoVebFC5k_RDhRy0grNlu5idwuVlljTsEAn0iXLH8xONttJhTMSmWoiOmkOVZxeQ9VdTab55xkYsLRYIgv_-LVbLhf_H9Yl-HOJ3coIIrQVP-6YMIOlMFnztmZT220ygNWSbW9gz5DAGTX2-mxl_3ctjTT4QaV0DFOg_8T15boqswvQFFYRNjVtKuDXLf0CDwrC6CSuAc4zDCbXgAA7tEcWUnA6GjPcaLVfTXMlkaOzTo01vHlO7rWs4f-kFM1Uk0SDJ83iP9r2IniCa6hfPHhEyKSW3yqSSC9PeYL2mAIEe02urRLxIP9UweCF5qTELX7wYM6MH2Euw6Sr5Od1sXX0ruZiYHWfa9YtV9HuwkqY1no3XMKHU4_38aYt1wW8mtrawgG_lNipmZlFU9LB-fxGS8Rq7aCTGR-94bL-uJiZwKhbumEcVDwcYr6KpggaLlX-uXkyc6rE-XTb7g62fd0__nzI9FRf3eI5mxQj38hw7ku0B5QZjsIqcCgKaW6M2506ARIiruOxQdJ2CGICMSOyBE8Y9Y5SQIUkLwmpF0ykfignhIFjx6vxGEM7bTuKmqGQfNgCGoL6uqeLog4XVSmU5wJknZjk_7fmEjVcA88XF45AaAWsvTOLxbD6JUSPuqz0kixA2hOb8BjNe6tGcPle3LCqk4sLrA59sPgc2TI-M0nOOv15Y4MrgFG86_wBkLqEAsxf9yaqeLyZDge68UOJGKy7kaRk3eqjBu7NKZGxjQZBleP3WIc-VKMuogaITxkJKRBJr4WSf3IzQspbdMjUzSe_peQdQG1mO8lM6x8MLs-pSwOzNwlJVyJFRo82U3H11-0UVNXqAH7hOXaT0p6JuTEDgycpGBUpBAcjZPQ0emcEO0Ow1IxElgEFuMLnX2ahvB26xR0sDqOwXw4RGbVtHczjowX84LeC4ojw2hMyRvlZ2JvfXiDPUVfMsfOqXUiEf4Wvc7MPUIVPzQpw_Mw0eFGVnfXH6ttRAF8utmqmclyJ4Bld-L0bWU6gC5CrrNaNLqw4b2MKifnbKrkBtP_tEo7YOrAgLdlKCWln1A1-VlxBcW7K4odXtuDEWbCNDMIXe0fgPCe9bfU8Bz_CYoyWJCpfdZqNg-4WojVjKTMVRgC7P2-6ITIeTlt-QEiK01yTZIPUQF8hTkblUhdb9P0_nKg98X7HZ62EbxKDy3taY42HEG6JY1c1RNq8147p9JYkhxhL4M3wArjDdgWY0Hqt8TvifHMmsASHhDpbBLxyGPZ6e3fHo7YCk0QH99EfNHkjfuUNTJphmIUzE9eY49G8FEsEsoLIF5gdIXnmHWEiQ8rS8Sc8Jk0nko1Udy00LoEfNwdgyO7Mslk4Z9_az06iHbR484gCyaaSb74ltv7NTosyG13sVGkzLTf0-GWO7nxotQ1b9_riGofF0jatlh1LXpUZo6-Exipf_SiHOI7SGRVIowogjjDCrg1RL1YvbSasDWbwm7QkvDyyFyomT1hIjwjoM8EP0h6nNlEvw86IBrHAwuSSw-8OHI1n1RqAk_kiZkU9Pq_9xyJ0q6mqK8rx5T_rNJNYhwOOntJwStdhZHnoHjXeIUUWiRFHD0G9Ks83UDT3YyxDcOJUN8Yc61mihyE7an347Hzc0u19QT1GZwSxZWurv0mQnkTVyZOwiBnNkIWsmy5HTbsWMV2qJXvKiITrlD5HVaRuSxGjuYabLcOUAix45orD8Iy5Pgx0rjiusDBfvjmfcrGWxPjDbK0cEQV7gIUOLUivgD4LjS-e6pd4BSkd1PPEIizt2jTEATKOv-bTjUphywBjRm7VHn-oE1bSqS4jWrBxgJHNTVhegzE-lYgucg5dACPOedGXmvHMXujISCA5RZLwn4Y16EsiCqRIffXYEpkoD-A5yu8eiunQZTI_zpRZeG9C-v4gooNyH2ZVRgDyxNv6K9TrP5exMo16lZxdyXUhLAvUHCob8jQfv5e-yaQVy8GLlCCWqZ28NfU14GtSk0LgMszoap9nyNKasN-ec4QPn-gnEhjRaPHkEi8kYZeTQV6kqp5STFP5eMzHwBSCelgyrlXyAhGZovv4nsGeXO3PY_8WVsZMn-dCc7Ba5Ivh3kgDBPLqUZoXKYGsP3co26qVlrWL-0m9AcZjcIVMt18ZnB9OCha2jAcI4gzaH720WMhGdUAISwXNKqcStyLQWACzUgV48pIdfhXWLRP5ZUQZJLJdJtfxBnOCeUb05eCdOwpdR7EedjWdy3nnAnov93AJtZeExELOafa4bha-IQOi_NZeKoHpYcWDdmfrjfl25mEI8fvkwBf8j7yPrmYgKexPAN5E699mcay-4-jHDqGfF73cS4M07QM-2ztDhnl_nIBsfHl_4hPhw3tFecFJIzb8zUHEV2nu5-M5dh8KqodXi1li_MgxLBO8EoE1y4_L7RvNDpRrKWuPy_xiJEpFqagPk6MamGNUUZIcX1ITt08d72Y1iV2wePWae2p8sTnpnNMJF0vPUkSPW_wNSfAFidEEeqpPaYQ_uFtS5akG2esHHgTiM8iQy9wqht6TBKhC6-HzRQ0Tt1t4s68irIGhjPqTvSJJ51lf3gmxme-vtTtEWb_LOM-eo6bwtgk50LLduYAd34haQVvkoRb-6E8d4C9lgmNYmDU1MHq6hjZm-GQCnJBDlnDlfiqclPUAfoIR0y00WyjJnY1OpEqbNC_ofgwolcadi7wr5G8l5zyIleWLmMPBMtf8ILqsrZdSVdr9IrawHD55tQ2IamfHZvttrf1x7DLZMQKgdH7BC6mhfWEojeXP5f1CPghzbom0VRXQMSxOkJ-jk2al6qT5fpLXQLyTosMJtZQzJHnGFYjjmIN0bjLrGUKvXizcJVJcSojC6FBbLIqcs3JBMdXVWrwZNGyknGHkq5qfKs_ETdg0t-o4Zo-SeUbbvLMl9u5hlrARXTU0HfdXi_uPlkU1j9-h7A7It98vIHTqxmlvTsjAbEhj3v2CewIdI-J7CfBjjGIV6eekguhy0z02UEN9t1_1_6lrKTzHThLyurXrPqzEFDGZogn9uRMvJmSZbx6KBb4GX30Nl0KYzzJncZA28dYLB6aRAVC-vCseZei4MiasMVXooVcFW_xJ0A72TAEBS6MFtvk6W0r-DHc9hXO6OuFSYj85cdCOIo-yRiYUoZn1A6kQHPK_vjWSQMWJVbVZZ-qIXUG2owikXxRdqhMzZmwLch-NH8fq4GzpFI4u_svryU5yvRGLFsygzQeOP6PA--Wrp1S-DbSKlKjGeaUfXTKhVv-2DIIT-kgIxABrDYE9F5U0-kDVXxh9hRaDq-GlfGEy_E98Hw8FKNgMvjx9gSqMaJqIkWE0Ws31_d7IJ8fHmVQlruIL9TC6lE05s2Yi0RC67mizAEhsQCaMuITLmnfZ6ruw4BWW_xhNhgu8j5urpDdOCzLzsL9ShdzAde4ojZIdCM2m-RKvibsVVfnC2J_3ARU-n9U7lOShQiveZTxU06icxyVIveWRuQSSe0SgEaLHZMsTqWUnPEYXv1oyaLEIXdGiKSZ8tuB3kUqC1XFsvbNfz2_88EJMb8Ydmy2qc4Yie03wjw_ikoHKLXZXMTSZppn-tLO1KqQv37AU9nmSxzO655S_YnkJjlqIkibZ_ax84w8FDiQRE-kyaonAZVS8PUKGFsRyNlXHftpO-6651FYfToTvGdn-Oh7xL0338TGuANRYv7weg61nTpvcbknd_UvsHHCZXSMKaS8PWk-DKKPTitEp2v9_-Bmi67d0kEY4TCjPUxornkVQVKvpEYaRcbwpIZ_VkepFNkq3dkuFx34rGuPy9dgYBDcmhYJKWKdvo1xiAC8qsDp-EjbKijLQeOr5mj12j0lUqs4KZOkEFRGxrEzXNraL5h1A9bQy1yb6r83IRuMvz4caRrosyikUZs6mrKKO25G4FYxZeA4sjXHnkT6f_9awVewjNEci2m0CI_wp6s3i-QBJ6vNljDPbCAFDSHuOQdyFuS_AxWEqT9iXBMNeJRMHpfysDQFsnRXTCH3WyK09DwPfP4xFN8V8g21lRC9Q-axcRDlrCa2XtNT_BNtZxcdzhkSwz0CeDG4j9uwVbun6VF7VWDqj0PrwGSl7Gb7Qw7k-3V2Ke_XI3Q688Y_0PQ3EakJ3ApVi-MDgPZhBtMaNsJe2ty1UN0zQHaBEY5WCPsqyNTngX7RzZTAyTA0WdPrb7goo0GWCph-_Ov6ZU-U0WcGBtwEfN5AlCo7o0pCaMF4wBk21OOwFMI9HFh74bv0yrEUW9KeqH4AIpNAmaJWKRVi-an1DrtIh0cRKr9sbJS0ycsdUY2yTvtv00G4Hr-Z1ErSpoTDdN82jCpIk6S6fvyllXck6DPDLIAiplSxUFCKK7D72b05S33V9BlFlKWC58_Wa7VddlLAEY7TDVe8JG_5li6QQZFQ==";

        String resultOfDecryptionService = DecryptionService.decryptFile(encryptedFileContents);
        assert (resultOfDecryptionService.equals(decryptedFileContents));
    }

}
